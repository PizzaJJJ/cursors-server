(function(w,C){function T(){return C.pointerLockElement===y||C.mozPointerLockElement===y||C.webkitPointerLockElement===y}function da(){a.fillStyle="#000000";a.font="35px NovaSquare";a.fillText("Please do not embed our website, thank you.",400-a.measureText("Please do not embed our website, thank you.").width/2,300);throw"Please do not embed our website, thank you.";}function ua(a){U(a)}function V(a,b){I=a;J=b;n=q=a;l=u=b;A=q<<1;B=u<<1}function va(a){if(z)return K=!1,U(a),!1;T()?W||(W=!0,V(n,l)):(W=
!1,z||L.checked||y.requestPointerLock&&y.requestPointerLock());if(K)K=!1,P();else if(U(a),(a.ctrlKey||a.shiftKey)&&!G.checked)X=!0,Q=n,R=l;else if(100<v-ea&&q==n&&u==l){ea=v;H.push([q<<1,u<<1,v]);wa(q,u);var b=[q,u];M.push(b);setTimeout(function(){M.remove(b)},1E3)}return!1}function xa(a){X=!1}function ya(){w.localStorage&&L&&(w.localStorage.setItem("noCursorLock",L.checked?"1":"0"),w.localStorage.setItem("noDrawings",G.checked?"1":"0"))}function U(a){if(T()){var b=a.webkitMovementX||a.mozMovementX||
a.movementX||0;a=a.webkitMovementY||a.mozMovementY||a.movementY||0;300>Math.abs(b)+Math.abs(a)&&(A+=b,B+=a,q=A>>1,u=B>>1)}else a.offsetX?(A=a.offsetX,B=a.offsetY):a.layerX&&(A=a.layerX,B=a.layerY),q=A>>1,u=B>>1;if(z)n=q,l=u;else if(Y(),!T()||q==n&&u==l||(a=b=0,q>n&&(b=1),u>l&&(a=1),q=n,u=l,A=(q<<1)+b,B=(u<<1)+a),X&&(Q!=n||R!=l)&&50<v-fa){b=Q;a=R;var c=n,e=l;if(!z&&null!=t&&t.readyState==WebSocket.OPEN){var f=new ArrayBuffer(9),d=new DataView(f);d.setUint8(0,3);d.setUint16(1,b,!0);d.setUint16(3,a,
!0);d.setUint16(5,c,!0);d.setUint16(7,e,!0);t.send(f)}Q=n;R=l;fa=v}}function Y(){ga(n,l)&&P();if(x(n,l)){a:{var a=n;var b=l,c=[],h=new Uint8Array(12E4);c.push([a,b]);h[a+400*b]=1;do{var f=c.shift(),d=f[0],f=f[1];if(!(0>d||0>f||400<=d||300<=f)){if(!x(d,f)){a={x:d,y:f};break a}h[d-1+400*f]||(c.push([d-1,f]),h[d-1+400*f]=1);h[d+1+400*f]||(c.push([d+1,f]),h[d+1+400*f]=1);h[d+400*(f-1)]||(c.push([d,f-1]),h[d+400*(f-1)]=1);h[d+400*(f+1)]||(c.push([d,f+1]),h[d+400*(f+1)]=1)}}while(0<c.length);a={x:a,y:b}}n=
a.x;l=a.y}if(n!=q||l!=u)a=ha(n,l,q,u),n=a.x,l=a.y;ga(n,l)&&P()}function Z(){S.set(za);m=[];H=[];N=[]}function ia(e){a.imageSmoothingEnabled=e;a.mozImageSmoothingEnabled=e;a.oImageSmoothingEnabled=e;a.webkitImageSmoothingEnabled=e}function Aa(){Z();console.log("Connected!")}function Ba(a){Z();console.log("Socket closed: "+a.reason)}function Ca(a){console.log("Socket error")}function Da(a,b){for(var c="",e=0,f;0!=(f=a.getUint8(b));++b)e<<=8,e|=f,f&128||(c+=String.fromCharCode(e),e=0);0!=e&&(c+=String.fromCharCode(e));
return[c,b+1]}function Ea(a,b){setTimeout(function(){var c=a.getUint16(b,!0),e=0;a:for(;e<c;e++){for(var f=a.getUint16(b+2+4*e,!0),d=a.getUint16(b+4+4*e,!0),k=0;k<M.length;k++){var g=M[k];if(g[0]==f&&g[1]==d){M.splice(k,1);continue a}}H.push([f<<1,d<<1,v])}},100);return b+2+4*a.getUint16(b,!0)}function Fa(a,b){!G.checked&&setTimeout(function(){for(var c=a.getUint16(b,!0),e=0;e<c;e++){var f=a.getUint16(b+2+8*e,!0),d=a.getUint16(b+4+8*e,!0),k=a.getUint16(b+6+8*e,!0),g=a.getUint16(b+8+8*e,!0);N.push([f<<
1,d<<1,k<<1,g<<1,v])}},50);return b+2+8*a.getUint16(b,!0)}function Ga(a){a=a.data;var b=new DataView(a);switch(b.getUint8(0)){case 0:ja=b.getUint32(1,!0);break;case 1:var c;ka=c=b.getUint16(1,!0);la=100<=c;var e=[];for(d in D)D.hasOwnProperty(d)&&e.push(d);for(var f=0;f<c;f++){var d=b.getUint32(3+8*f,!0);var k=b.getUint16(7+8*f,!0);var g=b.getUint16(9+8*f,!0);if(d!=ja)if(null!=D[d]){for(var n=0;n<e.length;n++)if(e[n]==d){e.splice(n,1);break}d=D[d];d.oldX=d.getX();d.oldY=d.getY();d.newX=k;d.newY=g;
d.time=v}else D[d]=new ma(k,g)}for(f=0;f<e.length;f++)delete D[e[f]];c=Ea(b,3+8*c);d=b.getUint16(c,!0);c+=2;for(e=0;e<d;e++){k=b.getUint32(c,!0);f=0;a:for(;f<m.length;f++)if(m[f].id==k){var l=m[f];if(1==l.type){k=l.x|0;g=l.y|0;for(var n=l.width|0,l=l.height|0,aa=g;aa<g+l;++aa)for(var ba=k;ba<k+n;++ba)--S[ba+400*aa]}m.splice(f,1);break a}c+=4}d=b.getUint16(c,!0);c+=2;for(e=0;e<d;e++){a:{f=b.getUint32(c,!0);for(k=0;k<m.length;k++)if(m[k].id==f){f=m[k];break a}f={id:f};m.push(f)}c+=4;c=na(b,c,f)}c=Fa(b,
c);if(a.byteLength<c+4)break;ca=b.getUint32(c,!0);break;case 4:Z();V(b.getUint16(1,!0),b.getUint16(3,!0));d=b.getUint16(5,!0);c=7;for(e=0;e<d;e++)f={},f.id=b.getUint32(c,!0),c+=4,c=na(b,c,f),m.push(f);a.byteLength>=c+4?E=Math.max(E,b.getUint32(c,!0)):a.byteLength>=c+2&&(E=Math.max(E,b.getUint16(c,!0)));Y();break;case 5:V(b.getUint16(1,!0),b.getUint16(3,!0)),9<=b.byteLength?E=Math.max(E,b.getUint32(5,!0)):7<=b.byteLength&&(E=Math.max(E,b.getUint16(5,!0))),Y()}}function P(){if(!(z||K||null==t||t.readyState!=
WebSocket.OPEN||n==I&&l==J)){var a=new ArrayBuffer(9),b=new DataView(a);b.setUint8(0,1);b.setUint16(1,n,!0);b.setUint16(3,l,!0);b.setUint32(5,E,!0);t.send(a);I=n;J=l}}function wa(a,b){if(!z&&null!=t&&t.readyState==WebSocket.OPEN){var c=new ArrayBuffer(9),e=new DataView(c);e.setUint8(0,2);e.setUint16(1,a,!0);e.setUint16(3,b,!0);e.setUint32(5,E,!0);t.send(c)}}function na(e,b,c){function h(){c.x=e.getUint16(b,!0);b+=2;c.y=e.getUint16(b,!0);b+=2;c.width=e.getUint16(b,!0);b+=2;c.height=e.getUint16(b,!0);
b+=2}function f(){for(var a=e.getUint32(b,!0).toString(16);6>a.length;)a="0"+a;b+=4;c.color="#"+a}var d=e.getUint8(b);b+=1;c.type=d;switch(d){case 255:break;case 0:c.x=e.getUint16(b,!0);b+=2;c.y=e.getUint16(b,!0);b+=2;c.size=e.getUint8(b);b+=1;c.isCentered=!!e.getUint8(b);b+=1;d=Da(e,b);c.text=d[0];b=d[1];break;case 1:h();var k=!c.color;f();d=c.x|0;var g=c.y|0,l=c.width|0,n=c.height|0;if(k)for(k=g;k<g+n;++k)for(var m=d;m<d+l;++m)++S[m+400*k];break;case 2:h();c.isBad=!!e.getUint8(b);b+=1;break;case 3:h();
c.count=e.getUint16(b,!0);b+=2;f();break;case 4:h();c.count?c.count>e.getUint16(b,!0)&&(c.lastClickAt=v):c.lastClickAt=0;c.count=e.getUint16(b,!0);b+=2;f();break;case 5:c.x=e.getUint16(b,!0);b+=2;c.y=e.getUint16(b,!0);b+=2;c.queue=[[0,c.x,c.y]];c.potentialQueue=[];c.explored=new Uint8Array(12E4);c.img=a.createImageData(400,300);d=C.createElement("canvas");d.width=400;d.height=300;c.canvas=d;c.ctx=c.canvas.getContext("2d");break;default:throw Error("Unknown object type "+d);}return b}function ga(a,
b){if(-1!=I&&-1!=J){var c=ha(I,J,a,b);if(c.x!=a||c.y!=b)return!0}for(c=0;c<m.length;c++){var e=m[c];if(2==e.type&&!(n<e.x||l<e.y||n>=e.x+e.width||l>=e.y+e.height))return!0}return!1}function oa(){a.clearRect(0,0,800,600);a.save();if(null!=t&&t.readyState!=WebSocket.OPEN||K){if(null==t)var e="Click to begin";else switch(t.readyState){case WebSocket.CONNECTING:e="Connecting";break;case WebSocket.CLOSING:case WebSocket.CLOSED:e="Lost connection to server";break;default:e="Click to begin"}a.font="60px NovaSquare";
a.fillText(e,400-a.measureText(e).width/2,315);pa();qa(!1)}else{a.fillStyle="#000000";a.save();a.globalAlpha=1;Ha();for(e=0;e<m.length;e++){var b=m[e];if(0==b.type){a.font=b.size+"px NovaSquare";var c=b.x<<1;var h=b.y<<1;b.isCentered&&(c-=a.measureText(b.text).width/2);a.fillStyle="#000000";a.fillText(b.text,c,h)}else if(1==b.type)a.fillStyle=b.color,a.fillRect(b.x<<1,b.y<<1,b.width<<1,b.height<<1),a.strokeStyle="#000000",a.globalAlpha=.2,a.lineWidth=2,a.strokeRect((b.x<<1)+1,(b.y<<1)+1,(b.width<<
1)-2,(b.height<<1)-2),a.globalAlpha=1;else if(2==b.type)a.fillStyle=b.isBad?"#FF0000":"#00FF00",a.globalAlpha=.2,a.fillRect(b.x<<1,b.y<<1,b.width<<1,b.height<<1),a.globalAlpha=1;else if(3==b.type){c=b.x<<1;h=b.y<<1;var f=b.width<<1;var d=b.height<<1;a.fillStyle=b.color;a.globalAlpha=.2;a.fillRect(c,h,f,d);a.globalAlpha=.5;a.fillStyle="#000000";40>b.width||40>b.height?(a.font="30px NovaSquare",a.fillText(b.count,c+f/2-a.measureText(b.count).width/2,h+d/2+10)):(a.font="60px NovaSquare",a.fillText(b.count,
c+f/2-a.measureText(b.count).width/2,h+d/2+20));a.globalAlpha=1}else if(4==b.type){c=b.x<<1;h=b.y<<1;f=b.width<<1;d=b.height<<1;a.fillStyle=b.color;a.strokeStyle=b.color;a.globalAlpha=1;a.fillRect(c,h,f,d);a.globalAlpha=.2;a.fillStyle="#000000";a.fillRect(c,h,f,d);a.globalAlpha=1;a.fillStyle=b.color;var k=150>v-b.lastClickAt,g=k?8:12;a.fillRect(c+g,h+g,f-2*g,d-2*g);a.strokeStyle="#000000";a.globalAlpha=.1;a.beginPath();a.moveTo(c,h);a.lineTo(c+g,h+g);a.moveTo(c+f,h);a.lineTo(c+f-g,h+g);a.moveTo(c,
h+d);a.lineTo(c+g,h+d-g);a.moveTo(c+f,h+d);a.lineTo(c+f-g,h+d-g);a.moveTo(c,h);a.rect(c,h,f,d);a.rect(c+g,h+g,f-2*g,d-2*g);a.stroke();a.fillStyle="#000000";a.globalAlpha=.5;50>b.width||50>b.height?(a.font="35px NovaSquare",a.fillText(b.count,c+f/2-a.measureText(b.count).width/2,h+d/2+13)):(a.font="45px NovaSquare",a.fillText(b.count,c+f/2-a.measureText(b.count).width/2,h+d/2+16));k&&(a.fillStyle="#000000",a.globalAlpha=.15,a.fillRect(c+g,h+g,f-2*g,d-2*g));a.globalAlpha=1}else 5==b.type&&(ia(!1),a.drawImage(b.canvas,
0,0,400,300,0,0,800,600),ia(!0))}a.restore();z||(a.font="12px NovaSquare",a.strokeStyle="#000000",a.fillStyle="#FFFFFF",a.lineWidth=2.5,e=la?"Area too full, not all cursors are shown":30<ka?"Area too full, drawing is disabled":"Use shift+click to draw",a.globalAlpha=.5,a.strokeText(e,10,590),a.globalAlpha=1,a.fillText(e,10,590),0!=ca&&(e=ca+" players online",b=a.measureText(e).width,a.globalAlpha=.5,a.strokeText(e,790-b,590),a.globalAlpha=1,a.fillText(e,790-b,590)));pa();if(!G.checked){a.save();a.strokeStyle=
"#000000";a.lineWidth=1;v=+new Date;for(e=0;e<N.length;e++)b=N[e],c=10-(v-b[4])/1E3,0>=c?(N.splice(e,1),--e):(1<c&&(c=1),a.globalAlpha=.3*c,a.beginPath(),a.moveTo(b[0]-.5,b[1]-.5),a.lineTo(b[2]-.5,b[3]-.5),a.stroke());a.restore()}a.save();for(var l in D)D.hasOwnProperty(l)&&a.drawImage(O,(D[l].getX()<<1)-6,(D[l].getY()<<1)-6);a.restore();qa(!0)}a.restore();w.requestAnimationFrame(oa)}function pa(){a.save();a.strokeStyle="#000000";v=+new Date;for(var e=0;e<H.length;e++){var b=H[e],c=(v-b[2])/1E3,h=
1-2*c;0>=h?(H.splice(e,1),--e):(c*=50,a.beginPath(),a.globalAlpha=.3*h,a.arc(b[0],b[1],c,0,2*Math.PI,!1),a.stroke())}a.restore()}function qa(e){if(z)a.save(),a.globalAlpha=1,a.drawImage(O,A-5,B-5);else{var b=0,c=0;q!=n||u!=l?(a.save(),e&&(a.globalAlpha=.2,a.fillStyle="#FF0000",a.beginPath(),a.arc(A+2,B+8,20,0,2*Math.PI,!1),a.fill()),a.globalAlpha=.5,a.drawImage(O,A-5,B-5),a.restore()):(b=A&1,c=B&1);a.save();e&&(a.globalAlpha=.2,a.fillStyle="#FFFF00",a.beginPath(),a.arc((n<<1)+b+2,(l<<1)+c+8,20,0,
2*Math.PI,!1),a.fill());a.globalAlpha=1;a.drawImage(Ia,(n<<1)+b-5,(l<<1)+c-5)}a.restore()}function ma(a,b){this.oldX=this.newX=a;this.oldY=this.newY=b;this.time=v}function ra(a){return a*a*(3-2*a)}function ha(a,b,c,h){a|=0;b|=0;c|=0;h|=0;if(x(a,b))return{x:a,y:b};if(a==c&&b==h)return{x:c,y:h};var e=a,d=b;c=c-a|0;h=h-b|0;var k=0,g=0,l=0,n=0;0>c?k=-1:0<c&&(k=1);0>h?g=-1:0<h&&(g=1);0>c?l=-1:0<c&&(l=1);var m=Math.abs(c)|0,q=Math.abs(h)|0;m<=q&&(m=Math.abs(h)|0,q=Math.abs(c)|0,0>h?n=-1:0<h&&(n=1),l=0);
c=m>>1;for(h=0;h<=m&&!x(a,b);h++)e=a,d=b,c+=q,c>=m?(c-=m,a+=k,b+=g):(a+=l,b+=n);return{x:e,y:d}}function x(a,b){return 0>a||400<=a||0>b||300<=b?!0:S[a+400*b]}function Ja(){for(var a=0;a<m.length;a++){var b=m[a];5==b.type&&Ka(b)}}function Ka(a){function b(a,b,c){g.push([c,a,b]);n[a+400*b]=!0;f(a,b)}function c(a,b,c){m.push([c,a,b]);n[a+400*b]=!0}function e(a,b){return 255!=l[4*(a+400*b)+3]&&!n[a+400*b]}function f(a,b){var c=4*(a+400*b);l[c+0]=255;l[c+1]=153;l[c+2]=153;l[c+3]=255}for(var d,k,g=a.queue,
l=a.img.data,n=a.explored,m=a.potentialQueue,q=g.length,r=0;r<m.length;r++)x(m[r][1],m[r][2])||(f(m[r][1],m[r][2]),g.push(m[r]),m.splice(r,1),--r);for(r=0;r<q;++r)x(g[r][1],g[r][2])&&(m.push(g[r]),g.splice(r,1),--r,--q);for(q=0;50>q&&0!=g.length;++q){d=Number.POSITIVE_INFINITY;for(var F=[g[0]],r=1;r<g.length;++r)k=g[r][0],.01>Math.abs(k-d)?F.push(g[r]):k<d&&(d=k,F=[g[r]]);for(r=0;r<F.length;++r){k=F[r][0];d=F[r][1];var p=F[r][2],sa=g.indexOf(F[r]);-1!=sa&&g.splice(sa,1);0<d&&e(d-1,p)&&(x(d-1,p)?c(d-
1,p,k+1):b(d-1,p,k+1));0<p&&e(d,p-1)&&(x(d,p-1)?c(d,p-1,k+1):b(d,p-1,k+1));400>d+1&&e(d+1,p)&&(x(d+1,p)?c(d+1,p,k+1):b(d+1,p,k+1));300>p+1&&e(d,p+1)&&(x(d,p+1)?c(d,p+1,k+1):b(d,p+1,k+1));0<d&&0<p&&e(d-1,p-1)&&(x(d-1,p-1)?c(d-1,p-1,k+Math.SQRT2):b(d-1,p-1,k+Math.SQRT2));0<d&&300>p+1&&e(d-1,p+1)&&(x(d-1,p+1)?c(d-1,p+1,k+Math.SQRT2):b(d-1,p+1,k+Math.SQRT2));400>d+1&&0<p&&e(d+1,p-1)&&(x(d+1,p-1)?c(d+1,p-1,k+Math.SQRT2):b(d+1,p-1,k+Math.SQRT2));400>d+1&&300>p+1&&e(d+1,p+1)&&(x(d+1,p+1)?c(d+1,p+1,k+Math.SQRT2):
b(d+1,p+1,k+Math.SQRT2))}}a.ctx.putImageData(a.img,0,0)}var y,a,ka=0,q=0,u=0,A=0,B=0,n=0,l=0,I=-1,J=-1,L=null,G=null,O=new Image;O.src="img/cursor.png";var Ia=O,z=-1!=w.location.search.indexOf("editor"),H=[],N=[],v=0,ea=0,t=null,ja=-1,D={},ca=0,la=!1,X=!1,Q=0,R=0,fa=0,W=!1,K=!z&&!0,S=new Uint8Array(12E4),m=[],M=[];Array.prototype.remove=function(a){a=this.indexOf(a);return-1!=a?(this.splice(a,1),!0):!1};var E=0;ma.prototype={oldX:0,oldY:0,newX:0,newY:0,time:0,getX:function(){var a=this.newX-this.oldX,
b=(v-this.time)/100,b=ra(0>=b?0:1<=b?1:b);return this.oldX+b*a},getY:function(){var a=this.newY-this.oldY,b=(v-this.time)/100,b=ra(0>=b?0:1<=b?1:b);return this.oldY+b*a}};var ta=function(){function e(){var a,b=a=0;var c=q/10;var e=u/10;d<c?(c=Math.ceil(c),a=Math.floor(d)):(c=Math.floor(c),a=Math.ceil(d));k<e?(e=Math.ceil(e),b=Math.floor(k)):(e=Math.floor(e),b=Math.ceil(k));if(a>c){var f=c;c=a;a=f}b>e&&(f=e,e=b,b=f);return{sx:a,sy:b,fx:c,fy:e}}function b(){f=!0;d=q/10;k=u/10}function c(a,b,c,e,d){a=
{x:10*~~(n/10)-~~(a/2)+c,y:10*~~(l/10)-~~(b/2)+e,width:a,height:b};for(var f in d)d.hasOwnProperty(f)&&(a[f]=d[f]);return a}function h(a,b){for(var c=null,e=Number.POSITIVE_INFINITY,d=0;d<m.length;d++){var f=m[d];if(f.hasOwnProperty("x")&&f.hasOwnProperty("y")&&f.hasOwnProperty("width")&&f.hasOwnProperty("height")){var g=f.x+f.width/2,F=f.y+f.height/2,g=(a-g)*(a-g)+(b-F)*(b-F);g<e&&(e=g,c=f)}}return c}var f=!1,d=0,k=0,g=1,t=200,v=150,x=new Uint8Array(1200),w="#000000 #FF9999 #9999FF #FFFF99 #99FFFF #FF99FF #3333FF".split(" ");
C.addEventListener("mouseup",function(){if(f){for(var a=e(),b=g,c=a.sy;c<a.fy;++c)for(var d=a.sx;d<a.fx;++d)x[d+40*c]=b;f=!1}});C.addEventListener("mousemove",function(){});C.addEventListener("keydown",function(a){if(z){var b=a.keyCode;65==b?(--g,0>g&&(g=w.length)):83==b?(++g,g>w.length&&(g=0)):66==b?1>=g||m.push(c(40,40,5,5,{type:4,color:w[g-1],colorCode:g-1,count:5})):90==b?m.pop():87==b?m.push(c(50,50,-5,-5,{type:2,isBad:!1})):79==b?(t=n,v=l):78==b?1>=g||m.push(c(40,40,0,0,{type:3,color:w[g-1],
colorCode:g-1,count:1})):37==b?(b=h(q,u),null!=b&&(a.shiftKey?b.width-=10:(b.x-=10,b.width+=10),0==b.width&&m.splice(m.indexOf(b),1))):39==b?(b=h(q,u),null!=b&&(a.shiftKey?(b.x+=10,b.width-=10):b.width+=10,0==b.width&&m.splice(m.indexOf(b),1))):38==b?(b=h(q,u),null!=b&&(a.shiftKey?b.height-=10:(b.y-=10,b.height+=10),0==b.height&&m.splice(m.indexOf(b),1))):40==b&&(b=h(q,u),null!=b&&(a.shiftKey?(b.y+=10,b.height-=10):b.height+=10,0==b.height&&m.splice(m.indexOf(b),1)))}});return{renderEditor:function(){if(z){a.save();
a.fillStyle="#FF0000";a.strokeStyle="#FF0000";a.lineWidth=1;a.globalAlpha=.09;a.beginPath();for(var b=0;400>b;b+=10)a.moveTo((b<<1)+.5,0),a.lineTo((b<<1)+.5,600);for(var c=0;300>c;c+=10)a.moveTo(0,(c<<1)+.5),a.lineTo(800,(c<<1)+.5);a.stroke();a.lineWidth=2;a.beginPath();a.moveTo(400.5,0);a.lineTo(400.5,600);a.moveTo(0,300.5,0);a.lineTo(800,300.5);a.stroke();a.lineWidth=1;a.globalAlpha=1;a.fillStyle="#000000";for(var d=e(),c=0;300>c;c+=10)for(b=0;400>b;b+=10){var h=b/10|0,k=c/10|0,l=x[h+40*k];f&&h>=
d.sx&&h<d.fx&&k>=d.sy&&k<d.fy&&(l=g);0!=l&&(a.fillStyle=w[l-1],a.fillRect(b<<1,c<<1,20,20))}a.save();a.globalAlpha=.09;a.fillStyle="#0000FF";a.beginPath();a.arc(t<<1,v<<1,20,0,2*Math.PI,!1);a.fill();a.restore();a.save();a.fillStyle="#FFFFFF";a.strokeStyle="#000000";a.lineWidth=2.5;a.font="14px NovaSquare";a.globalAlpha=.5;a.strokeText("Current color: ",10,590);a.globalAlpha=1;a.fillText("Current color: ",10,590);0==g?a.fillText("ESR",105,590):(a.fillStyle="#000000",a.fillRect(104,575,22,22),a.fillStyle=
w[g-1],a.fillRect(105,576,20,20));a.restore();a.restore()}},initEditor:function(){y.addEventListener("mousedown",b)}}}(),Ha=ta.renderEditor,La=ta.initEditor,za=new Uint8Array(12E4);Array.prototype.remove=function(a){a=this.indexOf(a);return-1!=a?(this.splice(a,1),!0):!1};w.onload=function(){y=C.getElementById("canvas");a=y.getContext("2d");try{w.top.location.origin!=w.location.origin&&da()}catch(e){da()}y.onmousemove=ua;y.onmousedown=va;y.onmouseup=xa;L=C.getElementById("noCursorLock");G=C.getElementById("noDrawings");
null!=localStorage&&(L.checked="1"==w.localStorage.getItem("noCursorLock")?!0:!1,G.checked="1"==w.localStorage.getItem("noDrawings")?!0:!1);w.onbeforeunload=ya;y.requestPointerLock=y.requestPointerLock||y.mozRequestPointerLock||y.webkitRequestPointerLock;y.style.cursor="none";La();z||null==t&&(t=new WebSocket("ws://kursors.io/ws/"),t.binaryType="arraybuffer",t.onopen=Aa,t.onmessage=Ga,t.onclose=Ba,t.onerror=Ca);setInterval(P,50);setInterval(Ja,40);w.requestAnimationFrame(oa)}})(window,document);
